import{q as L,i as E,c as N,B as v,r as T,a as l,b as d,o as r,f as i,e as n,n as O,l as C,t as c,u as a,aF as G,a6 as H,j as I,k as S,aE as P,h as b,w as u,p as x,aw as R,aG as q,a2 as A,G as Y,a5 as J,aa as K,x as Q,E as U,F as z,g as M}from"./index-C4szjxrb.js";import{_ as W}from"./CourseCard-TffUk2Yf.js";import{_ as X}from"./DateRange-DznmYu92.js";import{_ as Z}from"./CourseInstructors-B3F68-l4.js";import{_ as tt}from"./UserAvatar-Dm5-Kddr.js";import{_ as at}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Bd-WFY5M.js";const et={key:0,class:"border-2 rounded-md p-5 lg:w-72"},st={key:0},rt={key:1},nt={key:1,class:"text-xs bg-red-100 text-red-700 float-right px-2 py-0.5 rounded-md"},ct={key:2,class:"text-lg font-semibold mb-3 text-ink-gray-9"},ot={key:3,class:"flex items-center mb-3 text-ink-gray-7"},lt={class:"flex items-center mb-3 text-ink-gray-7"},dt={key:4,class:"flex items-center text-ink-gray-7"},it={key:5},D={__name:"BatchOverlay",props:{batch:{type:Object,default:null}},setup(e){const w=L(),k=E("$user"),y=window.read_only_mode,t=e,B=N({url:"lms.lms.utils.enroll_in_batch",makeParams(s){return{batch:t.batch.data.name}}}),$=()=>{k.data||(window.location.href=`/login?redirect-to=/batches/details/${t.batch.data.name}`),B.submit({},{onSuccess(s){K.success(__("You have been enrolled in this batch")),w.push({name:"Batch",params:{batchName:t.batch.data.name}})}})},o=v(()=>{var s,m,h,p;return(s=t.batch.data)!=null&&s.seat_count?((m=t.batch.data)==null?void 0:m.seat_count)-((p=(h=t.batch.data)==null?void 0:h.students)==null?void 0:p.length):null}),_=v(()=>{var s,m,h;return(h=(s=t.batch.data)==null?void 0:s.students)==null?void 0:h.includes((m=k.data)==null?void 0:m.name)}),g=v(()=>{var s;return(s=k.data)==null?void 0:s.is_moderator}),f=v(()=>{var s;return(s=k.data)==null?void 0:s.is_evaluator}),V=v(()=>{var s,m;return((m=(s=t.batch.data)==null?void 0:s.instructors)==null?void 0:m.filter(h=>{var p;return h.name===((p=k.data)==null?void 0:p.name)}).length)>0}),j=v(()=>g.value||_.value||f.value),F=v(()=>g.value||V.value);return(s,m)=>{const h=T("router-link");return e.batch.data?(r(),l("div",et,[e.batch.data.seat_count&&o.value>0?(r(),l("div",{key:0,class:O(["text-sm bg-green-100 text-green-700 px-2 py-1 rounded-md",e.batch.data.amount||e.batch.data.courses.length?"float-right":"w-fit mb-4"])},[C(c(o.value)+" ",1),o.value>1?(r(),l("span",st,c(s.__("Seats Left")),1)):o.value==1?(r(),l("span",rt,c(s.__("Seat Left")),1)):d("",!0)],2)):e.batch.data.seat_count&&o.value<=0?(r(),l("div",nt,c(s.__("Sold Out")),1)):d("",!0),e.batch.data.amount?(r(),l("div",ct,c(a(G)(e.batch.data.amount,e.batch.data.currency)),1)):d("",!0),e.batch.data.courses.length?(r(),l("div",ot,[i(a(H),{class:"h-4 w-4 stroke-1.5 mr-2"}),n("span",null,c(e.batch.data.courses.length)+" "+c(s.__("Courses")),1)])):d("",!0),i(X,{startDate:e.batch.data.start_date,endDate:e.batch.data.end_date,class:"mb-3"},null,8,["startDate","endDate"]),n("div",lt,[i(a(I),{class:"h-4 w-4 stroke-1.5 mr-2"}),n("span",null,c(a(S)(e.batch.data.start_time))+" - "+c(a(S)(e.batch.data.end_time)),1)]),e.batch.data.timezone?(r(),l("div",dt,[i(a(P),{class:"h-4 w-4 stroke-1.5 mr-2"}),n("span",null,c(e.batch.data.timezone),1)])):d("",!0),a(y)?d("",!0):(r(),l("div",it,[j.value?(r(),b(h,{key:0,to:{name:"Batch",params:{batchName:e.batch.data.name}}},{default:u(()=>[i(a(x),{variant:"solid",class:"w-full mt-4"},{prefix:u(()=>[_.value?(r(),b(a(R),{key:0,class:"size-4 stroke-1.5"})):(r(),b(a(q),{key:1,class:"size-4 stroke-1.5"}))]),default:u(()=>[n("span",null,c(_.value?s.__("Visit Batch"):s.__("Manage Batch")),1)]),_:1})]),_:1},8,["to"])):e.batch.data.paid_batch&&e.batch.data.seats_left>0&&e.batch.data.accept_enrollments?(r(),b(h,{key:1,to:{name:"Billing",params:{type:"batch",name:e.batch.data.name}}},{default:u(()=>[_.value?d("",!0):(r(),b(a(x),{key:0,class:"w-full mt-4",variant:"solid"},{prefix:u(()=>[i(a(A),{class:"size-4 stroke-1.5"})]),default:u(()=>[n("span",null,c(s.__("Register Now")),1)]),_:1}))]),_:1},8,["to"])):e.batch.data.allow_self_enrollment&&e.batch.data.seats_left&&e.batch.data.accept_enrollments?(r(),b(a(x),{key:2,variant:"solid",class:"w-full mt-2",onClick:m[0]||(m[0]=p=>$())},{prefix:u(()=>[i(a(Y),{class:"size-4 stroke-1.5"})]),default:u(()=>[C(" "+c(s.__("Enroll Now")),1)]),_:1})):d("",!0),F.value?(r(),b(h,{key:3,to:{name:"BatchForm",params:{batchName:e.batch.data.name}}},{default:u(()=>[i(a(x),{class:"w-full mt-2"},{prefix:u(()=>[i(a(J),{class:"size-4 stroke-1.5"})]),default:u(()=>[n("span",null,c(s.__("Edit")),1)]),_:1})]),_:1},8,["to"])):d("",!0)]))])):d("",!0)}}},ut={key:0,class:""},mt={class:"sticky top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},ht={class:"m-5 pb-10"},bt={class:"flex justify-between w-full"},_t={class:"md:w-2/3"},ft={class:"text-3xl font-semibold text-ink-gray-9"},vt={class:"my-3 leading-6 text-ink-gray-7"},kt={class:"flex avatar-group overlap"},gt=["innerHTML"],yt={class:"hidden md:block"},pt={key:0},xt={class:"flex items-center mt-10"},wt={class:"text-2xl font-semibold text-ink-gray-9"},Bt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-5"},$t={key:0},Nt=["innerHTML"],Et={__name:"BatchDetail",props:{batchName:{type:String,required:!0}},setup(e){E("$user");const w=L(),{brand:k}=Q(),y=e,t=N({url:"lms.lms.utils.get_batch_details",cache:["batch",y.batchName],params:{batch:y.batchName},auto:!0,onSuccess:o=>{o||w.push({name:"Batches"})}}),B=N({url:"lms.lms.utils.get_batch_courses",params:{batch:y.batchName},cache:["batchCourses",y.batchName],auto:!0}),$=v(()=>{var _,g;let o=[{label:"Batches",route:{name:"Batches"}}];return o.push({label:(_=t==null?void 0:t.data)==null?void 0:_.title,route:{name:"BatchDetail",params:{batchName:(g=t==null?void 0:t.data)==null?void 0:g.name}}}),o});return U(()=>{var o;return{title:(o=t==null?void 0:t.data)==null?void 0:o.title,icon:k.favicon}}),(o,_)=>{const g=T("router-link");return a(t).data?(r(),l("div",ut,[n("header",mt,[i(a(at),{items:$.value},null,8,["items"])]),n("div",ht,[n("div",bt,[n("div",_t,[n("div",ft,c(a(t).data.title),1),n("div",vt,c(a(t).data.description),1),n("div",kt,[n("div",{class:O(["h-6 mr-1",{"avatar-group overlap":a(t).data.instructors.length>1}])},[(r(!0),l(z,null,M(a(t).data.instructors,f=>(r(),b(tt,{user:f},null,8,["user"]))),256))],2),i(Z,{instructors:a(t).data.instructors},null,8,["instructors"])]),i(D,{batch:a(t),class:"md:hidden mt-5"},null,8,["batch"]),n("div",{class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-10",innerHTML:a(t).data.batch_details},null,8,gt)]),n("div",yt,[i(D,{batch:a(t)},null,8,["batch"])])]),a(t).data.courses.length?(r(),l("div",pt,[n("div",xt,[n("div",wt,c(o.__("Courses")),1)]),n("div",Bt,[a(t).data.courses?(r(!0),l(z,{key:0},M(a(B).data,f=>(r(),l("div",{key:f.course},[i(g,{to:{name:"CourseDetail",params:{courseName:f.name}}},{default:u(()=>[(r(),b(W,{course:f,key:f.name},null,8,["course"]))]),_:2},1032,["to"])]))),128)):d("",!0)]),a(t).data.batch_details_raw?(r(),l("div",$t,[n("div",{innerHTML:a(t).data.batch_details_raw,class:"batch-description"},null,8,Nt)])):d("",!0)])):d("",!0)])])):d("",!0)}}};export{Et as default};
//# sourceMappingURL=BatchDetail-DADL0vnJ.js.map
