import{s as j,v as L,cG as E,y as f,B as w,cH as I,c as T,a as r,o as s,b as h,e as u,n as V,l as U,t as y,f as d,w as m,u as a,bL as A,bV as G,cI as H,F as N,g as $,h as J,cJ as K,p as R,P as W,bW as X,cK as Q,cL as Y,bD as Z}from"./index-C4szjxrb.js";const ee={key:0,class:"text-ink-red-3"},te={class:"w-full"},se={class:"mt-1 rounded-lg bg-surface-white py-1 text-base border-2"},ae={class:"flex flex-col gap-1 p-1"},le={class:"text-base font-medium text-ink-gray-8"},re={class:"text-sm text-ink-gray-5"},oe={key:1,class:"text-ink-gray-7 px-4"},ue={key:2,class:"absolute bottom-2 left-1 w-[95%] pt-2 bg-white border-t"},ne={key:1,class:"grid grid-cols-2 gap-2 mt-1"},ie={class:"flex items-center justify-between break-all bg-surface-gray-2 text-ink-gray-7 word-wrap p-2 rounded-md mr-2"},ce={class:"break-all"},fe={__name:"MultiSelect",props:j({label:{type:String},size:{type:String,default:"sm"},doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},validate:{type:Function,default:null},errorMessage:{type:Function,default:n=>`${n} is an Invalid value`},required:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n,{expose:F}){const i=n,o=L(n,"modelValue"),C=E();f([]);const S=f(null),x=f(null),p=f(""),g=f(""),b=f(!1),B=w({get:()=>p.value||"",set:e=>{p.value="",e&&(b.value=!1),e!=null&&e.value&&z(e.value)}});I(p,e=>{e=e||"",g.value!==e&&(g.value=e,q(e))},{debounce:300,immediate:!0});const k=T({url:"frappe.desk.search.search_link",method:"POST",cache:[g.value,i.doctype],auto:!0,params:{txt:g.value,doctype:i.doctype}}),_=w(()=>(M(),k.data||[]));function q(e){k.update({params:{txt:e,doctype:i.doctype}}),k.reload()}const z=e=>{x.value=null,e&&(e.split(",").forEach(t=>{var c;if(t=t.trim(),t&&!((c=o.value)!=null&&c.includes(t))){if(t&&i.validate&&!i.validate(t)){x.value=i.errorMessage(t);return}o.value?o.value.push(t):o.value=[t],t=t.replace(t,"")}}),!x.value&&(e=""))},D=e=>{o.value=o.value.filter(l=>l!==e)};function M(){S.value.$el.focus()}F({setFocus:M});const O=w(()=>[{sm:"text-xs",md:"text-base"}[i.size||"sm"],"text-ink-gray-5"]);return(e,l)=>(s(),r("div",null,[n.label?(s(),r("label",{key:0,class:V(["block mb-1",O.value])},[U(y(n.label)+" ",1),n.required?(s(),r("span",ee,"*")):h("",!0)],2)):h("",!0),u("div",te,[d(a(Y),{modelValue:B.value,"onUpdate:modelValue":l[2]||(l[2]=t=>B.value=t),nullable:""},{default:m(()=>[d(a(A),{class:"w-full",show:b.value,"onUpdate:show":l[1]||(l[1]=t=>b.value=t)},{target:m(({togglePopover:t})=>[d(a(Q),{ref_key:"search",ref:S,class:"search-input form-input w-full focus-visible:!ring-0",type:"text",value:p.value,onChange:l[0]||(l[0]=c=>{p.value=c.target.value,b.value=!0}),autocomplete:"off"},null,8,["value"])]),body:m(({isOpen:t,close:c})=>[G(u("div",null,[u("div",se,[d(a(H),{class:V(["my-1 max-h-[12rem] overflow-y-auto px-1.5",_.value.length?"min-h-[6rem]":"min-h-[3.8rem]"]),static:""},{default:m(()=>[_.value.length?(s(!0),r(N,{key:0},$(_.value,v=>(s(),J(a(K),{key:v.value,value:v},{default:m(({active:P})=>[u("li",{class:V(["flex cursor-pointer items-center rounded px-2 py-1 text-base",{"bg-surface-gray-2":P}])},[u("div",ae,[u("div",le,y(v.description),1),u("div",re,y(v.value),1)])],2)]),_:2},1032,["value"]))),128)):(s(),r("div",oe,y(e.__("No results found")),1)),a(C).onCreate?(s(),r("div",ue,[d(a(R),{variant:"ghost",class:"w-full !justify-start",label:e.__("Create New"),onClick:v=>a(C).onCreate(c)},{prefix:m(()=>[d(a(W),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["label","onClick"])])):h("",!0)]),_:2},1032,["class"])])],512),[[X,t]])]),_:1},8,["show"])]),_:1},8,["modelValue"])]),o.value.length?(s(),r("div",ne,[(s(!0),r(N,null,$(o.value,t=>(s(),r("div",ie,[u("span",ce,y(t),1),d(a(Z),{class:"size-4 stroke-1.5 cursor-pointer",onClick:c=>D(t)},null,8,["onClick"])]))),256))])):h("",!0)]))}};export{fe as _};
//# sourceMappingURL=MultiSelect-Crx778mX.js.map
