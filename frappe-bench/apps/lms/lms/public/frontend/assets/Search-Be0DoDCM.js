import{d as B,y as h,x as R,z as $,q as J,aJ as N,c as T,J as g,E as j,a as o,e as n,f as u,u as c,b as f,w as p,bC as z,bH as H,t as d,F as x,g as E,bD as V,co as Y,n as P,$ as F,_ as I,i as K,aA as O,o as r}from"./index-C4szjxrb.js";import{_ as A}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Bd-WFY5M.js";const U={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},X={class:"w-4/6 mx-auto py-5"},G={class:"px-2.5"},W={class:"flex items-center"},Z={key:0,class:"text-sm text-ink-gray-5 mt-2"},Q={key:1,class:"text-sm text-ink-gray-5 mt-2"},ee={key:2,class:"text-sm text-ink-gray-5 mt-2"},ae={class:"mt-5"},se={key:0,class:""},te=["onClick"],ne={class:"space-y-1 w-full"},oe={class:"flex items-center"},re=["innerHTML"],ce={class:"text-sm text-ink-gray-5 ml-2"},le={key:0,class:"ml-auto text-sm text-ink-gray-5"},ie=["innerHTML"],he=B({__name:"Search",setup(ue){const a=h(""),b=h(null),t=h([]),{brand:k}=R(),l=J(),q=O(),_=h(!1),S=K("$dayjs");$(()=>{l.currentRoute.value.query.q&&(a.value=l.currentRoute.value.query.q,v())});const y=e=>{a.value=e,l.replace({query:e?{q:e}:{}})},v=N(()=>{a.value.length>2&&m.reload()},500),m=T({url:"lms.command_palette.search_sqlite",makeParams:()=>({query:a.value}),onSuccess(){C()}}),C=()=>{t.value=[],m.data&&(_.value=!1,m.data.forEach(e=>{e.items.forEach(i=>{t.value.push(i)})}),t.value.sort((e,i)=>i.score-e.score))},M=e=>{e.doctype=="LMS Course"?l.push({name:"CourseDetail",params:{courseName:e.name}}):e.doctype=="LMS Batch"?l.push({name:"BatchDetail",params:{batchName:e.name}}):e.doctype=="Job Opportunity"&&l.push({name:"JobDetail",params:{job:e.name}})};g(a,()=>{var e;a.value&&a.value!=((e=m.params)==null?void 0:e.query)?_.value=!0:a.value||(_.value=!1,t.value=[])}),g(()=>q.query.q,e=>{e&&e!==a.value&&(a.value=e,v())});const w=e=>e==="LMS Course"?__("Course"):e==="LMS Batch"?__("Batch"):e==="Job Opportunity"?__("Job"):e,L=()=>{a.value="",y("")};return j(()=>({title:__("Search"),icon:k.favicon})),(e,i)=>(r(),o(x,null,[n("header",U,[u(c(A),{items:[{label:e.__("Search")}]},null,8,["items"])]),n("div",X,[n("div",G,[u(c(H),{ref_key:"searchInput",ref:b,class:"flex-1",placeholder:"Search for a keyword or phrase and press enter",autocomplete:"off","model-value":a.value,"onUpdate:modelValue":y,onKeydown:i[0]||(i[0]=z(()=>c(v)(),["enter"]))},{prefix:p(()=>[u(c(Y),{class:"w-4 text-ink-gray-5"})]),suffix:p(()=>[n("div",W,[a.value?(r(),o("button",{key:0,onClick:L,class:"p-1 size-6 grid place-content-center focus:outline-none focus:ring focus:ring-outline-gray-3 rounded"},[u(c(V),{class:"w-4 text-ink-gray-7"})])):f("",!0)])]),_:1},8,["model-value"]),a.value&&t.value.length?(r(),o("div",Z,d(t.value.length)+" "+d(t.value.length===1?e.__("match"):e.__("matches")),1)):_.value?(r(),o("div",Q,d(e.__("Press enter to search")),1)):a.value&&!t.value.length?(r(),o("div",ee,d(e.__("No results found")),1)):f("",!0)]),n("div",ae,[t.value.length?(r(),o("div",se,[(r(!0),o(x,null,E(t.value,(s,D)=>(r(),o("div",{onClick:de=>M(s),class:"rounded-md cursor-pointer hover:bg-surface-gray-2 px-2"},[n("div",{class:P(["flex space-x-2 py-3",{"border-b":D!==t.value.length-1}])},[u(c(I),{text:s.author_info.full_name},{default:p(()=>[u(c(F),{label:s.author_info.full_name,image:s.author_info.user_image,size:"md"},null,8,["label","image"])]),_:2},1032,["text"]),n("div",ne,[n("div",oe,[n("div",{class:"font-medium text-ink-gray-9",innerHTML:s.title},null,8,re),n("div",ce,d(w(s.doctype)),1),s.published_on||s.start_date||s.creation?(r(),o("div",le,d(c(S)(s.published_on||s.start_date||s.creation).format("DD MMM YYYY")),1)):f("",!0)]),n("div",{class:"leading-5 text-ink-gray-7",innerHTML:s.content},null,8,ie)])],2)],8,te))),256))])):f("",!0)])])],64))}});export{he as default};
//# sourceMappingURL=Search-Be0DoDCM.js.map
