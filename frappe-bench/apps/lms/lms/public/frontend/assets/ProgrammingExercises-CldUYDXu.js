import{_ as Q}from"./EmptyState.vue_vue_type_script_setup_true_lang-BylHWie9.js";import{d as U,s as j,v as N,y,J as B,e_ as W,a as p,e as r,t as g,am as R,F as I,g as z,bV as X,b as S,eO as Y,f as o,h as T,u as a,p as h,w as n,b7 as Z,dd as ee,ao as O,l as k,P as A,az as se,o as i,H as F,B as J,D as te,e$ as ae,r as H,c4 as G,Q as q,aj as le,aa as $,cC as oe,x as re,z as ne,i as ie,q as ue,A as ce,E as de,ad as me}from"./index-C4szjxrb.js";import{_ as pe}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Bd-WFY5M.js";const ge={class:"text-xs text-ink-gray-5 mb-2"},_e={class:"overflow-x-auto overflow-y-visible border rounded-md"},ve=["onUpdate:modelValue"],fe=["onClick"],xe={class:"mt-2"},be=U({__name:"ChildTable",props:j({modelValue:{},columns:{default:()=>[]},label:{}},{modelValue:{},modelModifiers:{}}),emits:j(["update:modelValue"],["update:modelValue"]),setup(x,{emit:b}){const u=N(x,"modelValue"),c=y(null),f=y(null),d=y(""),w=y("0px"),P=b,C=y(x.columns);B(u,()=>{u.value&&u.value.length<1&&v()});const v=()=>{u.value||(u.value=[]);let s={};C.value.forEach(t=>{s[t.toLowerCase().split(" ").join("_")]=""}),u.value.push(s),M(),P("update:modelValue",u.value)},M=()=>{se(()=>{const t=document.querySelectorAll(".overflow-x-auto .grid")[u.value.length].querySelector("input");t&&t.focus()})},_=s=>{var t;(t=u.value)==null||t.splice(s,1),P("update:modelValue",u.value??[])},m=()=>[...Array(C.value.length).fill("1fr"),"0.25fr"].join(" "),E=(s,t)=>{const e=t.target.getBoundingClientRect();f.value=s,d.value=e.bottom+"px",w.value=e.right+"px"};W(c,()=>{f.value=null});const l=s=>C.value.map(e=>e.toLowerCase().split(" ").join("_")).includes(s);return(s,t)=>(i(),p("div",null,[r("div",ge,g(x.label),1),r("div",_e,[r("div",{class:"grid items-center space-x-4 p-2 border-b",style:R({gridTemplateColumns:m()})},[(i(!0),p(I,null,z(C.value,(e,V)=>(i(),p("div",{key:V,class:"text-sm text-ink-gray-5"},g(e),1))),128)),t[0]||(t[0]=r("div",null,null,-1))],4),(i(!0),p(I,null,z(u.value,(e,V)=>(i(),p("div",{key:V,class:"grid items-center space-x-4 p-2",style:R({gridTemplateColumns:m()})},[(i(!0),p(I,null,z(Object.keys(e),D=>(i(),p(I,{key:D},[l(D)?X((i(),p("input",{key:0,"onUpdate:modelValue":K=>e[D]=K,class:"py-1.5 px-2 border-none focus:ring-0 focus:border focus:border-gray-300 focus:bg-surface-gray-2 rounded-md text-sm focus:outline-none"},null,8,ve)),[[Y,e[D]]]):S("",!0)],64))),128)),r("div",{class:"relative",ref_for:!0,ref_key:"menuRef",ref:c},[o(a(h),{variant:"ghost",onClick:D=>E(V,D)},{icon:n(()=>[o(a(Z),{class:"size-4 text-ink-gray-7 stroke-1.5 cursor-pointer"})]),_:1},8,["onClick"]),(i(),T(ee,{to:"body"},[f.value===V?(i(),p("div",{key:0,style:R({position:"absolute",top:d.value,left:w.value}),class:"top-5 mt-1 w-32 bg-surface-white border border-outline-gray-1 rounded-md shadow-sm"},[r("button",{onClick:D=>_(V),class:"flex items-center space-x-2 w-full text-left px-3 py-2 text-sm text-ink-red-3"},[o(a(O),{class:"size-4 stroke-1.5"}),r("span",null,g(s.__("Delete")),1)],8,fe)],4)):S("",!0)]))],512)],4))),128))]),r("div",xe,[o(a(h),{onClick:v},{prefix:n(()=>[o(a(A),{class:"size-4 text-ink-gray-7"})]),default:n(()=>[k(" "+g(s.__("Add Row")),1)]),_:1})])]))}}),ye={class:"text-xl font-semibold text-ink-gray-9"},ke={class:"grid grid-cols-2 gap-10"},he={class:"space-y-4"},we={class:"text-xs text-ink-gray-5 mb-2"},Ce={class:"flex justify-end space-x-2 group"},Ee=U({__name:"ProgrammingExerciseForm",props:j({exerciseID:{default:"new"}},{modelValue:{},modelModifiers:{},exercises:{},exercisesModifiers:{}}),emits:["update:modelValue","update:exercises"],setup(x){const b=N(x,"modelValue"),u=N(x,"exercises"),c=y({title:"",language:"Python",problem_statement:"",test_cases:[]}),f=[{label:"Python",value:"Python"},{label:"JavaScript",value:"JavaScript"}],d=x;B(()=>d.exerciseID,()=>{w(),L()});const w=()=>{var s;let l=!0;(s=u.value)==null||s.data.forEach(t=>{t.name===d.exerciseID&&(l=!1,c.value={...t})}),l&&(c.value={title:"",language:"Python",problem_statement:"",test_cases:[]})},P=F({doctype:"LMS Test Case",fields:["input","expected_output","name"],cache:["testCases",d.exerciseID],parent:"LMS Programming Exercise",onSuccess(l){c.value.test_cases=l}}),L=()=>{P.update({filters:{parent:d.exerciseID,parenttype:"LMS Programming Exercise",parentfield:"test_cases"}}),P.reload()},C=()=>{c.value.title=oe(c.value.title.trim())},v=l=>{C(),d.exerciseID=="new"?M(l):_(l)},M=l=>{var s;(s=u.value)==null||s.insert.submit({...c.value},{onSuccess(){var t;l(),(t=u.value)==null||t.reload(),$.success(__("Programming Exercise created successfully"))},onError(t){var e;$.warning(__(((e=t.messages)==null?void 0:e[0])||t))}})},_=l=>{var s;(s=u.value)==null||s.setValue.submit({name:d.exerciseID,...c.value},{onSuccess(){var t;l(),(t=u.value)==null||t.reload(),$.success(__("Programming Exercise updated successfully"))},onError(t){var e;$.warning(__(((e=t.messages)==null?void 0:e[0])||t))}})},m=J(()=>["Input","Expected Output"]),E=l=>{var s;d.exerciseID!="new"&&((s=u.value)==null||s.delete.submit(d.exerciseID,{onSuccess(){$.success(__("Programming Exercise deleted successfully")),l()},onError(t){var e;$.warning(__(((e=t.messages)==null?void 0:e[0])||t))}}))};return(l,s)=>{const t=H("router-link");return i(),T(a(te),{modelValue:b.value,"onUpdate:modelValue":s[4]||(s[4]=e=>b.value=e),options:{size:"5xl"}},{"body-title":n(()=>[r("div",ye,g(d.exerciseID==="new"?l.__("Create Programming Exercise"):l.__("Edit Programming Exercise")),1)]),"body-content":n(()=>[r("div",ke,[r("div",he,[o(a(q),{modelValue:c.value.title,"onUpdate:modelValue":s[0]||(s[0]=e=>c.value.title=e),label:l.__("Title"),required:!0},null,8,["modelValue","label"]),o(a(q),{modelValue:c.value.language,"onUpdate:modelValue":s[1]||(s[1]=e=>c.value.language=e),label:l.__("Language"),type:"select",options:f,required:!0},null,8,["modelValue","label"]),o(be,{modelValue:c.value.test_cases,"onUpdate:modelValue":s[2]||(s[2]=e=>c.value.test_cases=e),label:l.__("Test Cases"),columns:m.value,required:!0,addable:!0,deletable:!0,editable:!0,placeholder:l.__("Add Test Case")},null,8,["modelValue","label","columns","placeholder"])]),r("div",null,[r("div",null,[r("div",we,[k(g(l.__("Problem Statement"))+" ",1),s[5]||(s[5]=r("span",{class:"text-ink-red-3"},"*",-1))]),o(a(le),{content:c.value.problem_statement,onChange:s[3]||(s[3]=e=>c.value.problem_statement=e),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[21rem] overflow-y-auto"},null,8,["content"])])])])]),actions:n(({close:e})=>[r("div",Ce,[x.exerciseID!="new"?(i(),T(a(h),{key:0,onClick:V=>E(e),variant:"outline",theme:"red",class:"invisible group-hover:visible"},{prefix:n(()=>[o(a(O),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(l.__("Delete")),1)]),_:1},8,["onClick"])):S("",!0),o(t,{to:{name:"ProgrammingExerciseSubmission",params:{exerciseID:d.exerciseID,submissionID:"new"}}},{default:n(()=>[o(a(h),null,{prefix:n(()=>[o(a(ae),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(l.__("Test this Exercise")),1)]),_:1})]),_:1},8,["to"]),o(t,{to:{name:"ProgrammingExerciseSubmissions",query:{exercise:d.exerciseID}}},{default:n(()=>[o(a(h),null,{prefix:n(()=>[o(a(G),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(l.__("Check Submission")),1)]),_:1})]),_:1},8,["to"]),o(a(h),{variant:"solid",onClick:V=>v(e)},{default:n(()=>[k(g(l.__("Save")),1)]),_:1},8,["onClick"])])]),_:1},8,["modelValue"])}}}),Ve={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},Pe={class:"space-x-2"},De={class:"md:w-4/5 md:mx-auto p-5"},Se={class:"flex items-center justify-between mb-5"},$e={key:0,class:"text-lg font-semibold text-ink-gray-9"},Ie={key:1,class:"grid grid-cols-2 gap-5"},Me={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Te=["onClick"],Le={class:"text-lg font-semibold text-ink-gray-9"},ze={class:"text-sm text-ink-gray-7"},Re={key:2,class:"flex justify-center my-5"},qe=U({__name:"ProgrammingExercises",setup(x){const b=y(0),u=window.read_only_mode,{brand:c}=re(),f=y(!1),d=y("new"),w=ie("$user"),P=ue();ne(()=>{L(),C()});const L=()=>{var _,m,E;!((_=w.data)!=null&&_.is_instructor)&&!((m=w.data)!=null&&m.is_moderator)&&!((E=w.data)!=null&&E.is_evaluator)&&P.push({name:"ProgrammingExerciseSubmissions"})},C=()=>{ce("frappe.client.get_count",{doctype:"LMS Programming Exercise"}).then(_=>{b.value=_}).catch(_=>{console.error("Error fetching exercise count:",_)})},v=F({doctype:"LMS Programming Exercise",cache:["programmingExercises"],fields:["name","title","language","problem_statement"],auto:!0,orderBy:"modified desc"});de(()=>({title:__("Programming Exercises"),icon:c.favicon}));const M=J(()=>[{label:__("Programming Exercises"),route:{name:"ProgrammingExercises"}}]);return(_,m)=>{var s,t;const E=H("router-link"),l=Q;return i(),p(I,null,[r("header",Ve,[o(a(pe),{items:M.value},null,8,["items"]),r("div",Pe,[o(E,{to:{name:"ProgrammingExerciseSubmissions"}},{default:n(()=>[o(a(h),null,{prefix:n(()=>[o(a(G),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(_.__("Check All Submissions")),1)]),_:1})]),_:1}),a(u)?S("",!0):(i(),T(a(h),{key:0,variant:"solid",onClick:m[0]||(m[0]=()=>{d.value="new",f.value=!0})},{prefix:n(()=>[o(a(A),{class:"h-4 w-4 stroke-1.5"})]),default:n(()=>[k(" "+g(_.__("Create")),1)]),_:1}))])]),r("div",De,[r("div",Se,[b.value?(i(),p("div",$e,g(_.__("{0} Exercises").format(b.value)),1)):S("",!0),(s=a(v).data)!=null&&s.length||b.value>0?(i(),p("div",Ie)):S("",!0)]),(t=a(v).data)!=null&&t.length?(i(),p("div",Me,[(i(!0),p(I,null,z(a(v).data,e=>(i(),p("div",{key:e.name,onClick:()=>{d.value=e.name,f.value=!0},class:"flex flex-col border rounded-md p-3 h-full hover:border-outline-gray-3 space-y-2 cursor-pointer"},[r("div",Le,g(e.title),1),r("div",ze,g(e.language),1)],8,Te))),128))])):(i(),T(l,{key:1,type:"Programming Exercises"})),a(v).data&&a(v).hasNextPage?(i(),p("div",Re,[o(a(h),{onClick:m[1]||(m[1]=e=>a(v).next())},{default:n(()=>[k(g(_.__("Load More")),1)]),_:1})])):S("",!0)]),o(Ee,{modelValue:f.value,"onUpdate:modelValue":m[2]||(m[2]=e=>f.value=e),exerciseID:d.value,exercises:a(v),"onUpdate:exercises":m[3]||(m[3]=e=>me(v)?v.value=e:null)},null,8,["modelValue","exerciseID","exercises"])],64)}}});export{qe as default};
//# sourceMappingURL=ProgrammingExercises-CldUYDXu.js.map
