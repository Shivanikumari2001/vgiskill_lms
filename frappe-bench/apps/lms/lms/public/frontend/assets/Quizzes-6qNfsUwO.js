import{x as I,y as z,z as J,i as q,q as O,aA as W,J as X,H as Y,B as T,E as Z,a as u,e as f,f as i,h as p,b as N,u as e,w as o,l as j,t as y,P as G,p as b,W as w,Q as x,F as $,g as B,U as K,T as ee,r as ae,Y as te,Z as se,X as ie,aM as oe,S as le,D as ne,aa as V,cC as re,o as n}from"./index-C4szjxrb.js";import{_ as ue}from"./EmptyState.vue_vue_type_script_setup_true_lang-BylHWie9.js";import{_ as de}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Bd-WFY5M.js";const ce={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},_e={class:"py-5 mx-5"},me={class:"flex items-center justify-between mb-4"},fe={class:"text-lg font-semibold text-ink-gray-7"},pe={key:0},ye={key:1,class:"text-xs text-ink-gray-5"},ke={key:2},he={class:"flex gap-2"},ve={key:2,class:"flex justify-center my-5"},xe={__name:"Quizzes",setup(ge){var M;const{brand:F}=I(),_=q("$user"),P=q("$dayjs"),Q=O(),U=W(),k=z(""),D=window.read_only_mode,h=z({}),v=z(!1),d=z("");J(()=>{var s,a,c,m;!((s=_.data)!=null&&s.is_moderator)&&!((a=_.data)!=null&&a.is_instructor)?Q.push({name:"Courses"}):(c=_.data)!=null&&c.is_moderator||(h.value.owner=(m=_.data)==null?void 0:m.name),U.query.new==="true"&&(v.value=!0)}),X(k,()=>{h.value.title=["like",`%${k.value}%`],r.update({filters:h.value}),r.reload()});const r=Y({doctype:"LMS Quiz",filters:h,fields:["name","title","passing_percentage","total_marks","show_answers","max_attempts","modified"],auto:!0,cache:["quizzes",(M=_.data)==null?void 0:M.name],orderBy:"modified desc",transform(s){return s.map(a=>({...a,modified:P(a.modified).fromNow()}))}}),E=()=>{d.value=re(d.value.trim())},L=s=>{E(),r.insert.submit({title:d.value},{onSuccess(a){V.success(__("Quiz created successfully")),s(),d.value="",Q.push({name:"QuizForm",params:{quizID:a.name}})},onError(a){V.error(__("Error creating quiz: {0}",a.message))}})},A=(s,a)=>{Array.from(s).forEach(async c=>{await r.delete.submit(c)}),a(),V.success(__("Quizzes deleted successfully"))},C=T(()=>[{label:__("Title"),key:"title",width:2,icon:"file-text"},{label:__("Total Marks"),key:"total_marks",width:1,align:"center",icon:"hash"},{label:__("Passing Percentage"),key:"passing_percentage",width:1,align:"center",icon:"percent"},{label:__("Max Attempts"),key:"max_attempts",width:1,align:"center",icon:"repeat"},{label:__("Show Answers"),key:"show_answers",width:1,align:"center",icon:"eye"},{label:__("Modified"),key:"modified",width:1,align:"center",icon:"clock"}]),R=T(()=>[{label:__("Quizzes"),route:{name:"Quizzes"}}]);return Z(()=>({title:__("Quizzes"),icon:F.favicon})),(s,a)=>{var m,S;const c=ae("router-link");return n(),u($,null,[f("header",ce,[i(e(de),{items:R.value},null,8,["items"]),e(D)?N("",!0):(n(),p(e(b),{key:0,variant:"solid",onClick:a[0]||(a[0]=t=>v.value=!0)},{prefix:o(()=>[i(e(G),{class:"w-4 h-4"})]),default:o(()=>[j(" "+y(s.__("Create")),1)]),_:1}))]),f("div",_e,[f("div",me,[f("div",fe,y((m=e(r).data)!=null&&m.length?s.__("{0} Quizzes").format(e(r).data.length):s.__("No Quizzes")),1),i(e(x),{modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=t=>k.value=t),type:"text",placeholder:"Search"},{prefix:o(()=>[i(e(w),{name:"search",class:"size-4 text-ink-gray-5"})]),_:1},8,["modelValue"])]),(S=e(r).data)!=null&&S.length?(n(),p(e(le),{key:0,columns:C.value,rows:e(r).data,"row-key":"name",options:{showTooltip:!1,selectable:!0}},{default:o(()=>[i(e(ee),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:o(()=>[(n(!0),u($,null,B(C.value,t=>(n(),p(e(K),{item:t},{prefix:o(({item:l})=>{var g;return[i(e(w),{name:(g=l.icon)==null?void 0:g.toString(),class:"h-4 w-4"},null,8,["name"])]}),_:2},1032,["item"]))),256))]),_:1}),i(e(ie),null,{default:o(()=>[(n(!0),u($,null,B(e(r).data,t=>(n(),p(c,{to:{name:"QuizForm",params:{quizID:t.name}}},{default:o(()=>[i(e(te),{row:t},{default:o(({column:l,item:g})=>[i(e(se),{item:t[l.key],align:l.align},{default:o(()=>[l.key=="show_answers"?(n(),u("div",pe,[i(e(x),{type:"checkbox",modelValue:t[l.key],"onUpdate:modelValue":H=>t[l.key]=H,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])])):l.key=="modified"?(n(),u("div",ye,y(t[l.key]),1)):(n(),u("div",ke,y(t[l.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1}),i(e(oe),null,{actions:o(({unselectAll:t,selections:l})=>[f("div",he,[i(e(b),{variant:"ghost",onClick:g=>A(l,t)},{default:o(()=>[i(e(w),{name:"trash-2",class:"h-4 w-4 stroke-1.5"})]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])):(n(),p(ue,{key:1,type:"Quizzes"})),e(r).hasNextPage?(n(),u("div",ve,[i(e(b),{onClick:a[2]||(a[2]=t=>e(r).next())},{default:o(()=>[j(y(s.__("Load More")),1)]),_:1})])):N("",!0)]),i(e(ne),{modelValue:v.value,"onUpdate:modelValue":a[4]||(a[4]=t=>v.value=t),options:{title:s.__("Create a Quiz"),size:"sm",actions:[{label:s.__("Save"),variant:"solid",onClick({close:t}){L(t)}}]}},{"body-content":o(()=>[i(e(x),{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=t=>d.value=t),label:s.__("Title"),type:"text"},null,8,["modelValue","label"])]),_:1},8,["modelValue","options"])],64)}}};export{xe as default};
//# sourceMappingURL=Quizzes-6qNfsUwO.js.map
