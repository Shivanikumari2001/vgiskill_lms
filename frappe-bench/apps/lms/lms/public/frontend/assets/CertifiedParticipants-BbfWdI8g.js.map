{"version":3,"file":"CertifiedParticipants-BbfWdI8g.js","sources":["../../../../frontend/src/pages/CertifiedParticipants.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<router-link :to=\"{ name: 'Batches', query: { certification: true } }\">\n\t\t\t<Button>\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<GraduationCap class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t</template>\n\t\t\t\t{{ __('Get Certified') }}\n\t\t\t</Button>\n\t\t</router-link>\n\t</header>\n\t<div class=\"mx-auto w-full max-w-4xl pt-6 pb-10\">\n\t\t<div class=\"flex flex-col md:flex-row justify-between mb-4 px-3\">\n\t\t\t<div class=\"text-xl font-semibold text-ink-gray-7 mb-4 md:mb-0\">\n\t\t\t\t{{ memberCount }} {{ __('certified members') }}\n\t\t\t</div>\n\t\t\t<div class=\"grid grid-cols-2 gap-2\">\n\t\t\t\t<FormControl\n\t\t\t\t\tv-model=\"nameFilter\"\n\t\t\t\t\t:placeholder=\"__('Search by Name')\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"min-w-40 lg:min-w-0 lg:w-32 xl:w-40\"\n\t\t\t\t\t@input=\"updateParticipants()\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"categories.data?.length\"\n\t\t\t\t\tclass=\"min-w-40 lg:min-w-0 lg:w-32 xl:w-40\"\n\t\t\t\t>\n\t\t\t\t\t<Select\n\t\t\t\t\t\tv-model=\"currentCategory\"\n\t\t\t\t\t\t:options=\"categories.data\"\n\t\t\t\t\t\t:placeholder=\"__('Category')\"\n\t\t\t\t\t\t@update:modelValue=\"updateParticipants()\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"participants.data?.length\" class=\"\">\n\t\t\t<template v-for=\"(participant, index) in participants.data\">\n\t\t\t\t<router-link\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'ProfileCertificates',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tusername: participant.username,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\"\n\t\t\t\t\tclass=\"flex h-15 rounded-md hover:bg-surface-gray-2 px-3\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"flex items-center w-full space-x-3 py-2\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t'border-b': index < participants.data.length - 1,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<UserAvatar :user=\"participant\" size=\"2xl\" />\n\n\t\t\t\t\t\t<div class=\"flex flex-col md:flex-row w-full\">\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<div class=\"text-base font-medium text-ink-gray-8\">\n\t\t\t\t\t\t\t\t\t{{ participant.full_name }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"participant.headline\"\n\t\t\t\t\t\t\t\t\tclass=\"mt-1.5 text-base text-ink-gray-5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ participant.headline }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"flex items-center space-x-3 md:space-x-24 text-sm md:text-base mt-1.5\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t{{ participant.certificate_count }}\n\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\tparticipant.certificate_count > 1\n\t\t\t\t\t\t\t\t\t\t\t? __('certificates')\n\t\t\t\t\t\t\t\t\t\t\t: __('certificate')\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class=\"text-ink-gray-4 md:hidden\">Â·</span>\n\t\t\t\t\t\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t{{ dayjs(participant.issue_date).format('DD MMM YYYY') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</router-link>\n\t\t\t</template>\n\t\t</div>\n\t\t<EmptyState v-else type=\"Certified Members\" />\n\t\t<div\n\t\t\tv-if=\"!participants.list.loading && participants.hasNextPage\"\n\t\t\tclass=\"flex justify-center mt-5\"\n\t\t>\n\t\t\t<Button @click=\"participants.next()\">\n\t\t\t\t{{ __('Load More') }}\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tAvatar,\n\tBreadcrumbs,\n\tButton,\n\tcall,\n\tcreateListResource,\n\tFormControl,\n\tSelect,\n\tusePageMeta,\n} from 'frappe-ui'\nimport { computed, inject, onMounted, ref } from 'vue'\nimport { GraduationCap } from 'lucide-vue-next'\nimport { sessionStore } from '../stores/session'\nimport EmptyState from '@/components/EmptyState.vue'\nimport UserAvatar from '@/components/UserAvatar.vue'\n\nconst currentCategory = ref('')\nconst filters = ref({})\nconst nameFilter = ref('')\nconst { brand } = sessionStore()\nconst memberCount = ref(0)\nconst dayjs = inject('$dayjs')\n\nonMounted(() => {\n\tsetFiltersFromQuery()\n\tupdateParticipants()\n})\n\nconst participants = createListResource({\n\tdoctype: 'LMS Certificate',\n\turl: 'lms.lms.api.get_certified_participants',\n\tstart: 0,\n\tcache: ['certified_participants'],\n\tpageLength: 100,\n})\n\nconst getMemberCount = () => {\n\tcall('lms.lms.api.get_count_of_certified_members', {\n\t\tfilters: filters.value,\n\t}).then((data) => {\n\t\tmemberCount.value = data\n\t})\n}\n\nconst categories = createListResource({\n\tdoctype: 'LMS Certificate',\n\turl: 'lms.lms.api.get_certification_categories',\n\tcache: ['certification_categories'],\n\tauto: true,\n\ttransform(data) {\n\t\tdata.unshift({ label: __(''), value: '' })\n\t\treturn data\n\t},\n})\n\nconst updateParticipants = () => {\n\tupdateFilters()\n\tgetMemberCount()\n\tsetQueryParams()\n\n\tparticipants.update({\n\t\tfilters: filters.value,\n\t})\n\tparticipants.reload()\n}\n\nconst updateFilters = () => {\n\tif (currentCategory.value) {\n\t\tfilters.value.category = currentCategory.value\n\t} else {\n\t\tdelete filters.value.category\n\t}\n\n\tif (nameFilter.value) {\n\t\tfilters.value.member_name = ['like', `%${nameFilter.value}%`]\n\t} else {\n\t\tdelete filters.value.member_name\n\t}\n}\n\nconst setQueryParams = () => {\n\tlet queries = new URLSearchParams(location.search)\n\tlet filterKeys = {\n\t\tcategory: currentCategory.value,\n\t\tname: nameFilter.value,\n\t}\n\n\tObject.keys(filterKeys).forEach((key) => {\n\t\tif (filterKeys[key]) {\n\t\t\tqueries.set(key, filterKeys[key])\n\t\t} else {\n\t\t\tqueries.delete(key)\n\t\t}\n\t})\n\thistory.replaceState(\n\t\t{},\n\t\t'',\n\t\t`${location.pathname}${queries.size > 0 ? `?${queries.toString()}` : ''}`\n\t)\n}\n\nconst setFiltersFromQuery = () => {\n\tlet queries = new URLSearchParams(location.search)\n\tnameFilter.value = queries.get('name') || ''\n\tcurrentCategory.value = queries.get('category') || ''\n}\n\nconst breadcrumbs = computed(() => [\n\t{\n\t\tlabel: __('Certified Members'),\n\t\troute: { name: 'CertifiedParticipants' },\n\t},\n])\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: __('Certified Members'),\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n<style>\n.headline {\n\tdisplay: -webkit-box;\n\t-webkit-line-clamp: 1;\n\t-webkit-box-orient: vertical;\n\ttext-overflow: ellipsis;\n\twidth: 100%;\n\toverflow: hidden;\n}\n</style>\n"],"names":["currentCategory","ref","filters","nameFilter","brand","sessionStore","memberCount","dayjs","inject","onMounted","setFiltersFromQuery","updateParticipants","participants","createListResource","getMemberCount","call","data","categories","updateFilters","setQueryParams","queries","filterKeys","key","breadcrumbs","computed","usePageMeta","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_component_router_link","Button","GraduationCap","_createTextVNode","__","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","FormControl","$event","_openBlock","_createElementBlock","_hoisted_6","Select","_hoisted_7","_Fragment","participant","index","_createBlock","UserAvatar","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_cache","_hoisted_14","EmptyState","_hoisted_15"],"mappings":"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"}