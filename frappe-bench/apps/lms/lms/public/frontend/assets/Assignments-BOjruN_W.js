import{d as z,s as E,v as L,ac as H,J as T,B as A,h as D,w as y,e as c,t as _,f as i,u as t,Q as I,eY as O,l as q,aj as Q,r as G,b as C,p as M,D as J,aa as U,cC as Y,bG as K,o as g,y as x,x as W,z as X,i as R,q as Z,aA as ee,H as se,A as te,E as ae,a as $,P as ne,S as le,ad as oe,F as ie}from"./index-C4szjxrb.js";import{_ as ue}from"./EmptyState.vue_vue_type_script_setup_true_lang-BylHWie9.js";import{_ as re}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Bd-WFY5M.js";const me={class:"p-5 text-base"},de={class:"text-lg text-ink-gray-9 font-semibold mb-5"},ce={class:"space-y-4 max-h-[75vh] overflow-y-auto"},pe={class:"text-xs text-ink-gray-5 mb-2"},ge={class:"flex justify-end space-x-2 mt-5"},fe=z({__name:"AssignmentForm",props:E({assignmentID:{type:String,default:"new"}},{modelValue:{},modelModifiers:{},assignments:{},assignmentsModifiers:{}}),emits:["update:modelValue","update:assignments"],setup(f){const m=L(f,"modelValue"),k=L(f,"assignments"),e=H({title:"",type:"",question:"",course:""}),o=f;T(()=>o.assignmentID,l=>{var a;l!=="new"&&((a=k.value)==null||a.data.forEach(p=>{p.name===l&&(e.title=p.title,e.type=p.type,e.question=p.question,e.course=p.course||"")}))},{flush:"post"}),T(m,l=>{l&&o.assignmentID==="new"&&(e.title="",e.type="",e.question="")});const v=()=>{e.title=Y(e.title.trim()),e.question=K(e.question)},b=()=>{v(),o.assignmentID=="new"?w():S()},w=()=>{k.value.insert.submit({...e},{onSuccess(){m.value=!1,U.success(__("Assignment created successfully"))}})},S=()=>{k.value.setValue.submit({...e,name:o.assignmentID},{onSuccess(){m.value=!1,U.success(__("Assignment updated successfully"))}})},V=A(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return(l,a)=>{const p=G("router-link");return g(),D(t(J),{modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=u=>m.value=u),options:{size:"lg"}},{body:y(()=>[c("div",me,[c("div",de,_(f.assignmentID==="new"?l.__("Create an Assignment"):l.__("Edit Assignment")),1),c("div",ce,[i(t(I),{modelValue:e.title,"onUpdate:modelValue":a[0]||(a[0]=u=>e.title=u),label:l.__("Title"),required:!0},null,8,["modelValue","label"]),i(t(I),{modelValue:e.type,"onUpdate:modelValue":a[1]||(a[1]=u=>e.type=u),type:"select",options:V.value,label:l.__("Submission Type"),required:!0},null,8,["modelValue","options","label"]),i(t(O),{modelValue:e.course,"onUpdate:modelValue":a[2]||(a[2]=u=>e.course=u),label:l.__("Course"),doctype:"LMS Course",placeholder:" "},null,8,["modelValue","label"]),c("div",null,[c("div",pe,[q(_(l.__("Question"))+" ",1),a[5]||(a[5]=c("span",{class:"text-ink-red-3"},"*",-1))]),i(t(Q),{content:e.question,onChange:a[3]||(a[3]=u=>e.question=u),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[18rem] overflow-y-auto"},null,8,["content"])])]),c("div",ge,[i(p,{to:{name:"AssignmentSubmissionList",query:{assignmentID:f.assignmentID}}},{default:y(()=>[f.assignmentID!=="new"?(g(),D(t(M),{key:0,variant:"subtle"},{default:y(()=>[q(_(l.__("Check Submissions")),1)]),_:1})):C("",!0)]),_:1},8,["to"]),i(t(M),{variant:"solid",onClick:b},{default:y(()=>[q(_(l.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"])}}}),ve={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ye={class:"md:w-3/4 md:mx-auto py-5 mx-5"},_e={class:"flex items-center justify-between mb-5"},be={key:0,class:"text-lg font-semibold text-ink-gray-9"},we={key:1,class:"grid grid-cols-2 gap-5"},Ve={key:2,class:"flex justify-center my-5"},Ae={__name:"Assignments",setup(f){const m=R("$user"),k=R("$dayjs"),e=x(""),o=x(""),v=x(!1),b=x("new"),w=x(0),{brand:S}=W(),V=Z(),l=ee(),a=window.read_only_mode;X(()=>{var n,s;!((n=m.data)!=null&&n.is_moderator)&&!((s=m.data)!=null&&s.is_instructor)&&V.push({name:"Courses"}),l.query.new==="true"&&(b.value="new",v.value=!0),P(),e.value=V.currentRoute.value.query.title,o.value=V.currentRoute.value.query.type}),T([e,o],()=>{V.push({query:{title:e.value,type:o.value}}),p()});const p=()=>{r.update({filters:u.value}),r.reload()},u=A(()=>{var s,h;let n={};return e.value&&(n.title=["like",`%${e.value}%`]),o.value&&(n.type=o.value),(s=m.data)!=null&&s.is_moderator||(n.owner=(h=m.data)==null?void 0:h.email),n}),r=se({doctype:"LMS Assignment",fields:["name","title","type","creation","question","course"],orderBy:"modified desc",cache:["assignments"],transform(n){return n.map(s=>({...s,creation:k(s.creation).fromNow()}))}}),j=A(()=>[{label:__("Title"),key:"title",width:2},{label:__("Type"),key:"type",width:1,align:"left"},{label:__("Created"),key:"creation",width:1,align:"right"}]),P=()=>{te("frappe.client.get_count",{doctype:"LMS Assignment"}).then(n=>{w.value=n})},B=A(()=>["","Document","Image","PDF","URL","Text"].map(s=>({label:__(s),value:s}))),N=A(()=>[{label:"Assignments",route:{name:"Assignments"}}]);return ae(()=>({title:__("Assignments"),icon:S.favicon})),(n,s)=>{var h,F;return g(),$(ie,null,[c("header",ve,[i(t(re),{items:N.value},null,8,["items"]),t(a)?C("",!0):(g(),D(t(M),{key:0,variant:"solid",onClick:s[0]||(s[0]=()=>{b.value="new",v.value=!0})},{prefix:y(()=>[i(t(ne),{class:"w-4 h-4"})]),default:y(()=>[q(" "+_(n.__("Create")),1)]),_:1}))]),c("div",ye,[c("div",_e,[w.value?(g(),$("div",be,_(n.__("{0} Assignments").format(w.value)),1)):C("",!0),(h=t(r).data)!=null&&h.length||w.value>0?(g(),$("div",we,[i(t(I),{modelValue:e.value,"onUpdate:modelValue":s[1]||(s[1]=d=>e.value=d),placeholder:n.__("Search by title")},null,8,["modelValue","placeholder"]),i(t(I),{modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=d=>o.value=d),type:"select",options:B.value,placeholder:n.__("Type")},null,8,["modelValue","options","placeholder"])])):C("",!0)]),(F=t(r).data)!=null&&F.length?(g(),D(t(le),{key:0,columns:j.value,rows:t(r).data,"row-key":"name",options:{showTooltip:!1,selectable:!1,onRowClick:d=>{t(a)||(b.value=d.name,v.value=!0)}}},null,8,["columns","rows","options"])):(g(),D(ue,{key:1,type:"Assignments"})),t(r).data&&t(r).hasNextPage?(g(),$("div",Ve,[i(t(M),{onClick:s[3]||(s[3]=d=>t(r).next())},{default:y(()=>[q(_(n.__("Load More")),1)]),_:1})])):C("",!0)]),i(fe,{modelValue:v.value,"onUpdate:modelValue":s[4]||(s[4]=d=>v.value=d),assignments:t(r),"onUpdate:assignments":s[5]||(s[5]=d=>oe(r)?r.value=d:null),assignmentID:b.value},null,8,["modelValue","assignments","assignmentID"])],64)}}};export{Ae as default};
//# sourceMappingURL=Assignments-BOjruN_W.js.map
