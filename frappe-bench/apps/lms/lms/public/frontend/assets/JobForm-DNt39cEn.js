import{x as z,c as b,ac as R,i as H,q as K,z as I,aa as w,bG as W,cC as A,B as p,E as G,a as j,e as l,f as n,u as t,w as g,l as c,t as i,p as C,Q as r,h as J,b as Q,aK as X,cB as Y,bE as Z,c6 as ee,bF as oe,bD as ae,aj as se,o as _}from"./index-C4szjxrb.js";import{_ as le}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Bd-WFY5M.js";const te={class:""},ne={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ie={class:"py-5"},re={class:"container border-b mb-4 pb-5"},de={class:"text-lg font-semibold mb-4 text-ink-gray-9"},me={class:"grid grid-cols-2 gap-5"},ue={class:"space-y-4"},be={class:"space-y-4"},pe={class:"container border-b mb-4 pb-5"},ce={class:"text-lg font-semibold mb-4 text-ink-gray-9"},_e={class:"grid grid-cols-2 gap-5"},ye={class:"block text-ink-gray-5 text-xs mb-1 mt-4"},fe={class:"mb-4"},ge={key:1,class:""},ve={class:"flex items-center"},ke={class:"border rounded-md p-2 mr-2"},Ve={class:"flex flex-col"},we={class:"text-sm text-ink-gray-4 mt-1"},je={class:"container mt-4"},Ce={class:"block text-ink-gray-5 text-xs mb-1"},Fe={__name:"JobForm",props:{jobName:{type:String,default:"new"}},setup(v){const y=H("$user"),m=K(),{brand:x}=z(),d=v,F=b({url:"frappe.client.insert",makeParams(e){var o;return{doc:{doctype:"Job Opportunity",company_logo:(o=a.image)==null?void 0:o.file_url,...a}}}}),N=b({url:"frappe.client.set_value",makeParams(e){return{doctype:"Job Opportunity",name:d.jobName,fieldname:{company_logo:a.image.file_url,...a}}}}),f=b({url:"frappe.client.get",makeParams(e){return{doctype:"Job Opportunity",name:d.jobName}},onSuccess(e){var o,u;e.owner!=((o=y.data)==null?void 0:o.name)&&!((u=y.data)!=null&&u.is_moderator)&&m.push({name:"Jobs"}),Object.keys(e).forEach(s=>{Object.hasOwn(a,s)&&(a[s]=e[s])}),e.company_logo&&O.reload({image:e.company_logo})}}),O=b({url:"lms.lms.api.get_file_info",makeParams(e){return{file_url:e.image}},auto:!1,onSuccess(e){a.image=e}}),a=R({job_title:"",location:"",country:"",type:"Full Time",work_mode:"On-site",status:"Open",company_name:"",company_website:"",image:null,description:"",company_email_address:""});I(()=>{y.data||m.push({name:"Jobs"}),d.jobName!="new"&&f.reload(),S()});const S=()=>{document.addEventListener("keydown",e=>{(e.metaKey||e.ctrlKey)&&e.key.toLowerCase()==="s"&&(e.preventDefault(),k())})},k=()=>{q(),f.data?U():T()},T=()=>{F.submit({},{onSuccess(e){m.push({name:"JobDetail",params:{job:e.name}})},onError(e){var o;w.error(((o=e.messages)==null?void 0:o[0])||e)}})},U=()=>{N.submit({},{onSuccess(e){m.push({name:"JobDetail",params:{job:e.name}})},onError(e){var o;w.error(((o=e.messages)==null?void 0:o[0])||e)}})},q=()=>{a.description=W(a.description),Object.keys(a).forEach(e=>{e!="description"&&typeof a[e]=="string"&&(a[e]=A(a[e]))})},D=e=>{a.image=e},E=()=>{a.image=null},$=p(()=>[{label:"Full Time",value:"Full Time"},{label:"Part Time",value:"Part Time"},{label:"Contract",value:"Contract"},{label:"Freelance",value:"Freelance"}]),h=p(()=>[{label:"On site",value:"On-site"},{label:"Hybrid",value:"Hybrid"},{label:"Remote",value:"Remote"}]),M=p(()=>[{label:"Open",value:"Open"},{label:"Closed",value:"Closed"}]),P=p(()=>[{label:"Jobs",route:{name:"Jobs"}},{label:d.jobName=="new"?"New Job":"Edit Job",route:{name:"JobForm"}}]);return G(()=>{var e;return{title:d.jobName=="new"?"New Job":(e=f.data)==null?void 0:e.job_title,icon:x.favicon}}),(e,o)=>{const u=X;return _(),j("div",te,[l("header",ne,[n(t(le),{items:P.value},null,8,["items"]),n(t(C),{variant:"solid",onClick:o[0]||(o[0]=s=>k())},{default:g(()=>[c(i(e.__("Save")),1)]),_:1})]),l("div",ie,[l("div",re,[l("div",de,i(e.__("Job Details")),1),l("div",me,[l("div",ue,[n(t(r),{modelValue:a.job_title,"onUpdate:modelValue":o[1]||(o[1]=s=>a.job_title=s),label:e.__("Title"),required:!0},null,8,["modelValue","label"]),n(t(r),{modelValue:a.type,"onUpdate:modelValue":o[2]||(o[2]=s=>a.type=s),label:e.__("Type"),type:"select",options:$.value,required:!0},null,8,["modelValue","label","options"]),n(t(r),{modelValue:a.work_mode,"onUpdate:modelValue":o[3]||(o[3]=s=>a.work_mode=s),label:e.__("Work Mode"),type:"select",options:h.value,required:!0},null,8,["modelValue","label","options"])]),l("div",be,[n(t(r),{modelValue:a.location,"onUpdate:modelValue":o[4]||(o[4]=s=>a.location=s),label:e.__("City"),required:!0},null,8,["modelValue","label"]),n(u,{modelValue:a.country,"onUpdate:modelValue":o[5]||(o[5]=s=>a.country=s),doctype:"Country",label:e.__("Country"),required:!0},null,8,["modelValue","label"]),v.jobName!="new"?(_(),J(t(r),{key:0,modelValue:a.status,"onUpdate:modelValue":o[6]||(o[6]=s=>a.status=s),label:e.__("Status"),type:"select",options:M.value,required:!0},null,8,["modelValue","label","options"])):Q("",!0)])])]),l("div",pe,[l("div",ce,i(e.__("Company Details")),1),l("div",_e,[l("div",null,[n(t(r),{modelValue:a.company_name,"onUpdate:modelValue":o[7]||(o[7]=s=>a.company_name=s),label:e.__("Company Name"),class:"mb-4",required:!0},null,8,["modelValue","label"]),n(t(r),{modelValue:a.company_website,"onUpdate:modelValue":o[8]||(o[8]=s=>a.company_website=s),label:e.__("Company Website"),required:!0},null,8,["modelValue","label"])]),l("div",null,[n(t(r),{modelValue:a.company_email_address,"onUpdate:modelValue":o[9]||(o[9]=s=>a.company_email_address=s),label:e.__("Company Email Address"),class:"mb-4",required:!0},null,8,["modelValue","label"]),l("label",ye,[c(i(e.__("Company Logo"))+" ",1),o[13]||(o[13]=l("span",{class:"text-ink-red-3"},"*",-1))]),a.image?(_(),j("div",ge,[l("div",ve,[l("div",ke,[n(t(ee),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),l("div",Ve,[l("span",null,i(a.image.file_name),1),l("span",we,i(t(oe)(a.image.file_size)),1)]),n(t(ae),{onClick:o[11]||(o[11]=s=>E()),class:"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})])])):(_(),J(t(Z),{key:0,fileTypes:["image/*"],validateFile:t(Y),onSuccess:o[10]||(o[10]=s=>D(s))},{default:g(({file:s,progress:B,uploading:V,openFileSelector:L})=>[l("div",fe,[n(t(C),{onClick:L,loading:V},{default:g(()=>[c(i(V?`Uploading ${B}%`:"Upload an image"),1)]),_:2},1032,["onClick","loading"])])]),_:1},8,["validateFile"]))])])]),l("div",je,[l("label",Ce,[c(i(e.__("Description"))+" ",1),o[14]||(o[14]=l("span",{class:"text-ink-red-3"},"*",-1))]),n(t(se),{content:a.description,onChange:o[12]||(o[12]=s=>a.description=s),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] mb-4"},null,8,["content"])])])])}}};export{Fe as default};
//# sourceMappingURL=JobForm-DNt39cEn.js.map
