import{x as A,y as S,z as H,i as N,q as z,H as w,B as C,c as R,b6 as D,E,a as o,e as i,f as c,u as t,h as U,b as f,w as V,l as F,t as _,p as M,F as B,g as P,$ as q,bD as X,bU as G,o as s}from"./index-C4szjxrb.js";import{_ as I}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Bd-WFY5M.js";import{T as J}from"./TabButtons-1rgcL6JH.js";const K={class:"sticky top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},O={class:"flex items-center space-x-2"},Q={class:"w-full md:w-3/4 mx-auto px-5 pt-6 divide-y"},W={class:"flex items-center"},Y=["innerHTML"],Z={class:"flex items-center space-x-2"},ee=["href","onClick"],ae={key:1,class:"text-ink-gray-5"},oe={__name:"Notifications",setup(te){var x,y;const{brand:L}=A(),d=N("$user"),k=N("$socket"),r=S("Unread"),T=z();H(()=>{d.data||T.push({name:"Courses"}),k.on("publish_lms_notifications",a=>{n.reload()})});const p=C(()=>r.value==="Unread"?n.data:u.data),n=w({doctype:"Notification Log",url:"lms.lms.api.get_notifications",filters:{for_user:(x=d.data)==null?void 0:x.name,read:0},auto:!0,cache:"Unread Notifications"}),u=w({doctype:"Notification Log",url:"lms.lms.api.get_notifications",filters:{for_user:(y=d.data)==null?void 0:y.name,read:1},auto:!0,cache:"Read Notifications"}),$=R({url:"lms.lms.api.mark_as_read",makeParams(a){return{name:a.name}},onSuccess(a){n.reload(),u.reload()}}),b=R({url:"lms.lms.api.mark_all_as_read",onSuccess(a){n.reload(),u.reload()}}),h=(a,l)=>{$.submit({name:l})};D(()=>{k.off("publish_lms_notifications")});const j=C(()=>[{label:"Notifications",route:{name:"Notifications"}}]);return E(()=>({title:"Notifications",icon:L.favicon})),(a,l)=>{var v,g;return s(),o(B,null,[i("header",K,[c(t(I),{items:j.value},null,8,["items"]),i("div",O,[r.value==="Unread"&&((v=t(n).data)==null?void 0:v.length)>0?(s(),U(t(M),{key:0,onClick:t(b).submit,loading:t(b).loading},{default:V(()=>[F(_(a.__("Mark all as read")),1)]),_:1},8,["onClick","loading"])):f("",!0),c(t(J),{class:"inline-block",buttons:[{label:"Unread",active:!0},{label:"Read"}],modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value=e)},null,8,["modelValue"])])]),i("div",Q,[(g=p.value)!=null&&g.length?(s(!0),o(B,{key:0},P(p.value,e=>(s(),o("div",{key:e.name,class:"flex items-center py-2 justify-between"},[i("div",W,[c(t(q),{image:e.user_image,label:e.full_name,class:"mr-2"},null,8,["image","label"]),i("div",{class:"notification text-ink-gray-7",innerHTML:e.subject},null,8,Y)]),i("div",Z,[e.link?(s(),o("a",{key:0,href:e.link,onClick:m=>h(m,e.name),class:"text-ink-gray-5 font-medium text-sm hover:text-ink-gray-7"},_(a.__("View")),9,ee)):f("",!0),e.read?f("",!0):(s(),U(t(M),{key:1,variant:"ghost",onClick:G(m=>h(m,e.name),["stop"])},{icon:V(()=>[c(t(X),{class:"h-4 w-4 text-ink-gray-7 stroke-1.5"})]),_:1},8,["onClick"]))])]))),128)):(s(),o("div",ae,_(a.__("Nothing to see here.")),1))])],64)}}};export{oe as default};
//# sourceMappingURL=Notifications-DoLJ7nBm.js.map
