# replicaCount: 1

# image:
#   repository: asia-south1-docker.pkg.dev/variphi/vgiskill/lms-app
#   pullPolicy: Always
#   tag: "latest"

# imagePullSecrets: []
# nameOverride: ""
# fullnameOverride: ""

# serviceAccount:
#   create: true
#   annotations: {}
#   name: ""

# podAnnotations: {}

# podSecurityContext:
#   runAsUser: 1000
#   runAsGroup: 1000
#   fsGroup: 1000

# securityContext:
#   allowPrivilegeEscalation: false
#   capabilities:
#     drop:
#     - ALL
#   readOnlyRootFilesystem: false

# service:
#   type: ClusterIP
#   port: 8000
#   targetPort: 8000
#   socketioPort: 9000

# ingress:
#   enabled: true
#   className: "gce"
#   annotations:
#     kubernetes.io/ingress.class: "gce"
#     kubernetes.io/ingress.global-static-ip-name: "lms-ingress-ip"
#     ingress.gcp.kubernetes.io/pre-shared-cert: "mcrt-71298f60-a102-44b4-ae9f-40dc28d1462c"
#     kubernetes.io/ingress.allow-http: "false"
#   hosts:
#     - host: vgiskill.ai
#       paths:
#         - path: /socket.io
#           pathType: Prefix
#           backendPort: socketio
#         - path: /
#           pathType: Prefix
#           backendPort: http
#   tls: []

# resources:
#   limits:
#     cpu: 2000m
#     memory: 8Gi
#   requests:
#     cpu: 1000m
#     memory: 4Gi

# nodeSelector:
#   cloud.google.com/gke-nodepool: gke-prod-asia-south1-np-app-prod

# tolerations: []

# affinity: {}

# autoscaling:
#   enabled: false
#   minReplicas: 1
#   maxReplicas: 10
#   targetCPUUtilizationPercentage: 80
#   targetMemoryUtilizationPercentage: 80

# # Database Configuration
# db:
#   host: "10.30.0.2"
#   port: 3306
#   user: "vgi_skill"
#   password: "vgiskill@2026"
#   name: "lms_db"
#   rootUser: "root"
#   rootPassword: "vgiskill@2026#"

# # Redis Configuration
# redis:
#   cache: "redis://redis:6379"
#   queue: "redis://redis:6379"
#   socketio: "redis://redis:6379"

# # Application Configuration
# app:
#   port: 8000
#   socketioPort: 9000
#   siteName: "vgiskill.ai"
#   siteUrl: "https://vgiskill.ai"
#   adminPassword: "admin"

# # Persistent Volumes
# persistence:
#   sites:
#     enabled: true
#     storageClass: "standard-rwo"
#     size: 20Gi
#     accessMode: ReadWriteOnce
#   logs:
#     enabled: true
#     storageClass: "standard-rwo"
#     size: 5Gi
#     accessMode: ReadWriteOnce



replicaCount: 2

image:
  repository: asia-south1-docker.pkg.dev/variphi/vgiskill/lms-app
  pullPolicy: IfNotPresent
  tag: "" # CI/CD --set image.tag=${{ github.sha }} se set karega

imagePullSecrets: []

nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false

# -------------------------
# SERVICE
# -------------------------
service:
  type: ClusterIP
  port: 8000
  targetPort: 8000
  socketioPort: 9000

# -------------------------
# INGRESS (GCE)
# -------------------------
ingress:
  enabled: true
  className: "gce"
  annotations:
    kubernetes.io/ingress.class: "gce"
    kubernetes.io/ingress.global-static-ip-name: "lms-ingress-ip"
    ingress.gcp.kubernetes.io/pre-shared-cert: "mcrt-71298f60-a102-44b4-ae9f-40dc28d1462c"
    kubernetes.io/ingress.allow-http: "false"
  hosts:
    - host: vgiskill.ai
      paths:
        - path: /socket.io
          pathType: Prefix
          backendPort: socketio
        - path: /
          pathType: Prefix
          backendPort: http
  tls: []

# -------------------------
# RESOURCES
# -------------------------
resources:
  requests:
    cpu: "1000m"
    memory: "4Gi"
  limits:
    cpu: "2000m"
    memory: "8Gi"

# -------------------------
# NODE SELECTION
# -------------------------
nodeSelector:
  cloud.google.com/gke-nodepool: gke-prod-asia-south1-np-app-prod

tolerations: []
affinity: {}

# -------------------------
# AUTOSCALING (HPA)
# -------------------------
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 6
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 75

# ⚠️ IMPORTANT
# Jab autoscaling enabled ho, replicaCount ko minReplicas ke equal rakho

# -------------------------
# DATABASE (SECRET-BASED)
# -------------------------
db:
  host: "10.30.0.2"
  port: 3306
  user: "vgi_skill"
  name: "lms_db"

  passwordSecret: lms-secrets
  passwordKey: db-password

  rootPasswordSecret: lms-secrets
  rootPasswordKey: db-root-password

# -------------------------
# REDIS
# -------------------------
redis:
  cache: "redis://redis:6379"
  queue: "redis://redis:6379"
  socketio: "redis://redis:6379"

# -------------------------
# APPLICATION
# -------------------------
app:
  port: 8000
  socketioPort: 9000
  siteName: "vgiskill.ai"
  siteUrl: "https://vgiskill.ai"

  adminPasswordSecret: lms-secrets
  adminPasswordKey: admin-password

# -------------------------
# PERSISTENCE
# -------------------------
persistence:
  sites:
    enabled: true
    storageClass: "standard-rwo"
    size: 20Gi
    accessMode: ReadWriteOnce

  logs:
    enabled: true
    storageClass: "standard-rwo"
    size: 5Gi
    accessMode: ReadWriteOnce
